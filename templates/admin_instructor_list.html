<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instructor Management</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style_instructor_list.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="tabs">
            <div class="tab" id="instructions-tab" onclick="showTab('instructions')">
                <h3>INSTRUCTIONS</h3>
            </div>
            <div class="tab" id="profile-tab" onclick="showTab('profile')">
                <h3>PROFILE</h3>
            </div>
        </div>

        <!-- INSTRUCTIONS sheet content -->
        <div id="instructions" class="sheet-content">
            <button class="add-btn">+ Add Instructor</button>
            <div class="table-container">
                <table id="instructor-table">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0)">Actions</th>
                            <th onclick="sortTable(1)">Surname</th>
                            <th onclick="sortTable(2)">Name</th>
                            <th onclick="sortTable(3)">Email</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="row1" onclick="showProfile('Giacomo', 'Guizzanesi', 'poli@inbox.lv')">
                            <td>
                                <button class="action-btn envelope-btn" onclick="sendEmail('poli@inbox.lv')"><i class="fas fa-envelope"></i></button>
                                <button class="action-btn edit-btn" onclick="editInstructor('row1')"><i class="fas fa-edit"></i></button>
                                <button class="action-btn delete-btn" onclick="confirmDelete('row1')"><i class="fas fa-times-circle"></i></button>
                                <button class="action-btn invite-btn" onclick="sendInvitation('poli@inbox.lv')"><i class="fas fa-paper-plane"></i></button>
                            </td>
                            <td id="username1">Giacomo</td>
                            <td id="name1">Guizzanesi</td>
                            <td id="email1">poli@inbox.lv</td>
                        </tr>
                        <tr id="row2" onclick="showProfile('Marco', 'Botton', 'poli@gmail.com')">
                            <td>
                                <button class="action-btn envelope-btn" onclick="sendEmail('poli@gmail.com')"><i class="fas fa-envelope"></i></button>
                                <button class="action-btn edit-btn" onclick="editInstructor('row2')"><i class="fas fa-edit"></i></button>
                                <button class="action-btn delete-btn" onclick="confirmDelete('row2')"><i class="fas fa-times-circle"></i></button>
                                <button class="action-btn invite-btn" onclick="sendInvitation('poli@gmail.com')"><i class="fas fa-paper-plane"></i></button>
                            </td>
                            <td id="username2"></td>
                            <td id="name2"></td>
                            <td id="email2"></td>
                        </tr>
                        <tr id="row3" onclick="showProfile('Mariah', 'Adelaide', 'mariah@gmail.com')">
                            <td>
                                <button class="action-btn envelope-btn" onclick="sendEmail('mariah@gmail.com')"><i class="fas fa-envelope"></i></button>
                                <button class="action-btn edit-btn" onclick="editInstructor('row3')"><i class="fas fa-edit"></i></button>
                                <button class="action-btn delete-btn" onclick="confirmDelete('row3')"><i class="fas fa-times-circle"></i></button>
                                <button class="action-btn invite-btn" onclick="sendInvitation('mariah@gmail.com')"><i class="fas fa-paper-plane"></i></button>
                            </td>
                            <td id="username3"></td>
                            <td id="name3"></td>
                            <td id="email3"></td>
                        </tr>
                        <tr id="row4" onclick="showProfile('Valerie', 'Liberty', 'liberty@hotmail.com')">
                            <td>
                                <button class="action-btn envelope-btn" onclick="sendEmail('liberty@hotmail.com')"><i class="fas fa-envelope"></i></button>
                                <button class="action-btn edit-btn" onclick="editInstructor('row4')"><i class="fas fa-edit"></i></button>
                                <button class="action-btn delete-btn" onclick="confirmDelete('row4')"><i class="fas fa-times-circle"></i></button>
                                <button class="action-btn invite-btn" onclick="sendInvitation('liberty@hotmail.com')"><i class="fas fa-paper-plane"></i></button>
                            </td>
                            <td id="username4"></td>
                            <td id="name4"></td>
                            <td id="email4"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- PROFILE sheet content -->
        <div id="profile" class="sheet-content" style="display:none;">
            <p>Click on an instructor's name to view their profile details here.</p>
            <div id="profile-details">
                <!-- Profile details will be shown here dynamically -->
            </div>
        </div>

        <!-- Confirmation Dialog -->
        <div id="confirmation-dialog" style="display: none;">
            <p>Are you sure you want to delete this instructor?</p>
            <button onclick="deleteInstructor()">Yes</button>
            <button onclick="cancelDelete()">No</button>
        </div>
    </div>

    <script>
        // Switch between the INSTRUCTIONS and PROFILE tabs
        function showTab(tabName) {
            const instructionsTab = document.getElementById("instructions");
            const profileTab = document.getElementById("profile");
            const instructionsTabBtn = document.getElementById("instructions-tab");
            const profileTabBtn = document.getElementById("profile-tab");

            instructionsTab.style.display = "none";
            profileTab.style.display = "none";
            instructionsTabBtn.classList.remove("active");
            instructionsTabBtn.classList.add("inactive");
            profileTabBtn.classList.remove("active");
            profileTabBtn.classList.add("inactive");

            if (tabName === "instructions") {
                instructionsTab.style.display = "block";
                instructionsTabBtn.classList.remove("inactive");
                instructionsTabBtn.classList.add("active");
            } else {
                profileTab.style.display = "block";
                profileTabBtn.classList.remove("inactive");
                profileTabBtn.classList.add("active");
            }
        }

        // Send email using the default email client
        function sendEmail(email) {
            window.location.href = `mailto:${email}`;
        }

        // Trigger edit mode for an instructor's details
        function editInstructor(rowId) {
            const username = document.getElementById("username1");
            const name = document.getElementById("name1");
            const email = document.getElementById("email1");

            username.innerHTML = `<input type="text" value="${username.innerHTML}">`;
            name.innerHTML = `<input type="text" value="${name.innerHTML}">`;
            email.innerHTML = `<input type="text" value="${email.innerHTML}">`;
        }

        // Confirm deletion of an instructor
        function confirmDelete(rowId) {
            document.getElementById("confirmation-dialog").style.display = "flex";
            window.currentRowId = rowId;
        }

        // Delete the instructor
        function deleteInstructor() {
            const row = document.getElementById(window.currentRowId);
            row.remove(); 
            document.getElementById("confirmation-dialog").style.display = "none";
        }

        // Cancel delete action
        function cancelDelete() {
            document.getElementById("confirmation-dialog").style.display = "none";
        }

        // Send invitation to instructor (just a mock-up here)
        function sendInvitation(email) {
            alert(`Invitation sent to ${email}`);
        }

        // Sorting function for the table
        function sortTable(columnIndex) {
            const table = document.getElementById("instructor-table");
            const rows = Array.from(table.rows).slice(1);  // Get all rows except the header
            const isNumericColumn = columnIndex === 3; // The email column (columnIndex 3) contains strings, not numbers

            rows.sort((a, b) => {
                const cellA = a.cells[columnIndex].innerText.trim();
                const cellB = b.cells[columnIndex].innerText.trim();

                if (isNumericColumn) {
                    return cellA.localeCompare(cellB);
                }

                // Sorting for non-numeric columns
                return cellA.localeCompare(cellB);
            });

            // Reattach sorted rows to the table body
            rows.forEach(row => table.appendChild(row));
        }
    </script>
</body>
</html>